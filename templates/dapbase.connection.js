// dapbase.connection.js
// Auto-generated by Dapbase — DO NOT EDIT manually unless you know what you're doing

console.log("Dapbase → Connection file loaded");

const path = require('path');
const fs = require('fs');

const DAPBASE_ROOT = path.join(__dirname, '..');
const CONFIG_PATH = path.join(__dirname, 'dapbase.config.json');

let currentDb = null;

const db = {
  // Switch to a database (folder must exist inside Dapbase/)
  async use(databaseName) {
    const dbPath = path.join(DAPBASE_ROOT, databaseName);
    if (!fs.existsSync(dbPath)) {
      throw new Error(`Database "${databaseName}" not found. Create folder: Dapbase/${databaseName}`);
    }
    currentDb = databaseName;
    console.log(`Using database: ${databaseName}`);
    return db;
  },

  // Placeholder methods (we'll implement them step by step)
  createTable: () => { throw new Error("Not implemented yet — coming soon!") },
  insert: () => { throw new Error("Not implemented yet — coming soon!") },
  select: () => { throw new Error("Not implemented yet — coming soon!") },
  update: () => { throw new Error("Not implemented yet — coming soon!") },
  delete: () => { throw new Error("Not implemented yet — coming soon!") },
};

module.exports = db;